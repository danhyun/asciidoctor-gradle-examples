buildscript {
    ext {
        asciidoctorVersion = '1.5.2'
    }

    repositories {
        jcenter()
    }

    dependencies {
        classpath "org.asciidoctor:asciidoctor-gradle-plugin:${asciidoctorVersion}"
    }
}

plugins {
    id 'org.ajoberstar.github-pages' version '1.1.0'
    id 'org.asciidoctor.gradle.asciidoctor' version '1.5.1'
}

githubPages {
    repoUri = project.hasProperty('githubRepo') ? project.githubRepo : ''

    credentials {
        username = project.hasProperty('githubUsername') ? project.githubUsername : ''
        password = project.hasProperty('githubPassword') ? project.githubPassword : ''
    }

    pages {
        from file("$rootDir/build/asciidoc/html5")
    }
}

apply plugin: 'java'
apply plugin: 'org.asciidoctor.convert'

asciidoctorj {
    version = asciidoctorVersion
}

asciidoctor {
    sourceDir = file("$rootProject.buildDir")
    sources {
        include 'index.adoc'
    }

    backends 'html5'

    attributes 'icons': 'font',
            'setanchors': 'true',
            'rootDir': file(rootDir),
            docinfo1: ''
}

publishGhPages.dependsOn asciidoctor